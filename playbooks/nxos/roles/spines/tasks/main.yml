---
# tasks file for spines
#
- name: Enable Features
  cisco.nxos.nxos_feature:
    feature: "{{ item.feature }}"
    state: enabled
  loop: "{{ spines_features }}"

- name: Configure loopback interfaces
  cisco.nxos.nxos_interfaces:
    config:
      - name: "{{ item.interface }}"
        enabled: true
  loop: "{{ loopbacks }}"

- name: Configure Interface IP Addresses
  cisco.nxos.nxos_l3_interfaces:
    config:
      - name: "{{ item.interface }}"
        ipv4:
          - address: "{{ item.addr }}/{{ item.mask }}"
  loop: "{{ loopbacks }}"

- name: Save the running configuration
  cisco.nxos.nxos_config:
    save_when: always
